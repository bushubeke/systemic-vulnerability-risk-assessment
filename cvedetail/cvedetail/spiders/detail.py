import scrapy
from scrapy.utils.trackref import NoneType
from .. items import CveItem
class cve1999(scrapy.Spider):
    name='cvedetail'

    addr=['https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={x}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=1999&month=0&cweid=0&order=1&trc=894&sha=8fdcb89732c98600636042e1eff8c1b2ff5cb25d' for x in range(1,18) ]+\
    [ f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2000&month=1&cweid=0&order=1&trc=68&sha=617aa6e317b3bca026f391037ded8cf157e73537' for i in range(1,2)]+\
    [ f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2001&month=0&cweid=0&order=1&trc=1677&sha=cd286d8b4654232a886b489ca0e2a4674400ed62' for i in range(1,34)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2002&month=0&cweid=0&order=1&trc=2156&sha=8a5f8f9448bfc93707fb8d5bbf8e4dcae250419b' for i in range(1,43)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2002&month=0&cweid=0&order=1&trc=2156&sha=8a5f8f9448bfc93707fb8d5bbf8e4dcae250419b' for i in range(1,31)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2004&month=0&cweid=0&order=1&trc=2451&sha=cb414d7af8966a8c160d1c600650c689d247f4b4' for i in range(1,50)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2005&month=0&cweid=0&order=1&trc=4935&sha=2cd2ed245e42f805737721589a777cffcd26804a' for i in range(1,99)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2006&month=0&cweid=0&order=1&trc=6610&sha=6fef0b092c4f019f8e35afa183e788c588cbb248' for i in range(1,133)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2007&month=0&cweid=0&order=1&trc=6520&sha=4c29d906712993bec6be8fca33faf1a74e5bbfe3' for i in range(1,131)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2008&month=0&cweid=0&order=1&trc=5632&sha=8b755637fdd9952103edeaae4cc277e7fb3e3dc4' for i in range(1,113)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2009&month=0&cweid=0&order=1&trc=5736&sha=d9173a349ac541da2e5bb6fb228e00a3b90d9d34' for i in range(1,115)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2010&month=0&cweid=0&order=1&trc=4652&sha=cc97d9af84c806c74850adf02dad6e9b12542db6' for i in range(1,94)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2011&month=0&cweid=0&order=1&trc=4155&sha=0b1f4462b5c3ed3cf0192383b9ec116f581ed999' for i in range(1,84)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2012&month=0&cweid=0&order=1&trc=5297&sha=0a9dac3932901d9df6deef0274bf697de3e2af62' for i in range(1,106)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2013&month=0&cweid=0&order=1&trc=5191&sha=26c01ab9eec35767344d3a6391486b1ababac5df' for i in range(1,104)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2014&month=0&cweid=0&order=1&trc=7946&sha=fba8a6ff372c42f9d7efdbf042d6e04930afd260' for i in range(1,159)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2015&month=0&cweid=0&order=1&trc=6484&sha=f941b721732be362e81064704448767014116e7c' for i in range(1,130)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2016&month=0&cweid=0&order=1&trc=6447&sha=b2d0ce7be64b618108f6397df50faa8a88561917' for i in range(1,129)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2017&month=0&cweid=0&order=1&trc=14714&sha=815cc1a3d2c4b72bf23b8a2fa85939f5ab0041c0' for i in range(1,295)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2018&month=0&cweid=0&order=1&trc=16556&sha=ca71c61a82c282d77dd98454cd1098033e7f6a87' for i in range(1,332)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2019&month=0&cweid=0&order=1&trc=12174&sha=06eae532a6d5b0054c1986953e99779c5827e3a7' for i in range(1,244)]+\
    [f'https://www.cvedetails.com/vulnerability-list.php?vendor_id=0&product_id=0&version_id=0&page={i}&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=2020&month=0&cweid=0&order=1&trc=12174&sha=06eae532a6d5b0054c1986953e99779c5827e3a7' for i in range(1,367)]
    
    start_urls=[
       x for x in addr
    ]
   
    def parse(self,response):
        items=CveItem()
        rescss=response.css('#vulnslisttable > tr')
        for i in range(1,len(rescss)):
                if i%2==0:
                    cveid=rescss[i-1].css("td")[1].css("::text").extract()[0]
                    try:
                      cweid=rescss[i-1].css("td")[2].css("::text").extract()[0]
                    except:
                      cweid="nocweid"
                    
                    try:
                      vulnerability_type=rescss[i-1].css("td")[4].css("::text").extract()[0].split("\t")[6]
                    except:
                      vulnerability_type="nothing"
                #    num_of_exploits=
                    try:
                      publish_date=rescss[i-1].css("td")[5].css("::text").extract()[0]
                    except:
                      publish_date="nodate"
                    try:
                      upadate_date=rescss[i-1].css("td")[6].css("::text").extract()[0]
                    except:
                      upadate_date="nodate"
                    
                    try:
                      score=rescss[i-1].css("td")[7].css("::text").extract()[0]
                    except:
                      score="noscore"
                    
                    try:
                      gained_access_level=rescss[i-1].css("td")[8].css("::text").extract()[0]
                    except:
                      gained_access_level="nolevel"
                    
                    try:
                      access=rescss[i-1].css("td")[9].css("::text").extract()[0]
                    except:
                      access="novalue"
                    
                    try:
                      complexity=rescss[i-1].css("td")[10].css("::text").extract()[0]
                    except:
                      complexity="novalue"

                    try:
                      Authentication=rescss[i-1].css("td")[11].css("::text").extract()[0]
                    except:
                      Authentication="novalue"
                    
                    try:
                      conf=rescss[i-1].css("td")[12].css("::text").extract()[0]
                    except:
                      conf="novalue"
                    try:
                      integrity=rescss[i-1].css("td")[13].css("::text").extract()[0]
                    except:
                      integrity="novalue"
                    try:
                      Availablity=rescss[i-1].css("td")[14].css("::text").extract()[0]
                    except:
                      Availablity="novalue"
                    
                    try:
                      Description=rescss[i].css("td::text").extract()[0].split("\t")[6]
                    except:
                      Description="novalue"
                    
                    
                    items['cve_id']=cveid
                    items['cwe_id']=cweid
                    items['vulnerability_type']=vulnerability_type
                    items['publish_date']=publish_date
                    items['upadate_date']=upadate_date
                    items['score']=score
                    items['gained_access_level']=gained_access_level
                    items['access']=access
                    items['complexity']=complexity
                    items['Authentication']=Authentication
                    items['conf']=conf
                    items['integrity']=integrity,
                    items['Availablity']=Availablity
                    items['Description']=Description

                
                    yield items
                else:
                    continue
